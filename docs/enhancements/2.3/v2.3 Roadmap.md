# Meta-Instruction
Under each header are the things that need to be fixed or features that need to be created, as well as the conditions for success. This document serves as scaffolding for the complete plan which will be detailed by Claude at the time of implementation. All implementation will document every step completed and follow a rigorous checklist, to prevent loss of development situational awareness.

If an Agent does not yet exist, create it and develop develop its necessary capabilities and workflow application routes. . 

Reporting Agents are not presented through the Operational UI, all Reporting Agents will be managed through the Administration page and deliver all output through the Operations Manager Agent. 

# Troubleshooting
- Review the images within the ts-img folder, "[issue-name]/image"
    - Utilize all agents and tools until the issue is completely repaired


# v2.3 Objectives (UI-UX = Zero-Wasted Ations)
Use Tavily MCP to determine and create a plan which of these would be the most vialbe solution for the ageentic reporting system. Or of a custom solution is ideal, create the scaffolding and benchmark requirements for the custom solution.

Also consider the framework in the [2.4 Roadmap](/home/cmndcntrl/code/rtpi/docs/enhancements/2.4/v2.420%Roadmap.md) when making a determination. 

[1](https://github.com/cmndcntrlcyber/mem0)

[2](https://github.com/topoteretes/cognee)

[3](https://github.com/MemoriLabs/Memori)

[4](https://github.com/NevaMind-AI/memU)

[5](https://github.com/letta-ai/agent-file)

# Status Reporting
## Roles
- Operaitons Manager Agent
  - Delegates tasks according to operational need
- (Specialty) Task Agent
  - Completes the Task
- (Specialty) Reporter Agent
  - Reports the Task as completed to Operations manager

Also consider the framework in the [2.4 Roadmap](/home/cmndcntrl/code/rtpi/docs/enhancements/2.4/v2.420%Roadmap.md) when making a determination for how to develop these roles  
  
# New Directory Structure
## Group Side-Panel Objects Based on Features and Nature
[REQUIRED!!!]: ENSURE ALL ROUTES AND LINKS ARE FULLY OPERATIONAL AFTER EACH CHANGE. CHECK ALL LINKS AND ROUTES 3 TIMES: 

1. AFTER CHANGES ARE MADE 
2. AFTER A PARENT SECTION IS COMPLETED 
3. AFTER ALL PAGES HAVE BEEN REORGANIZED AND CONSOLIDATED.

All link relationships should be retained throughout development.  

NO BROKEN LINKS!!! 

All pages UI-UX should behave as they do now unless explicitly instructed otherwise

# Dashboard

## Operations
### Operations Manager (Incorporated into Operations Page)
- Integrate the "Operations Manager" functions and features within the Operations Page
    - a floating 2x2" square chat window  for user input  
    - Create a .tsx file that triggers default "Surface Assessment" scans and ATT&CK Reconnaissance against the "in-Scope" targets of an operation
        - Trigger activates when the operation is submited, switched to "Active" and "Active is confirmed by human operator.
        - Findings are stored in `Discovered Services (JSON)` 
        - Replace `Notes/Metadata (JSON)` fields with `BBOT OUTPUT (JSON)`
            - Target Reporter Agent will read the output of the BBOT Scan and Paste the scan output into the `BBOT OUTPUT (JSON)` Field
            - Operations Manager will send data and tasks to Relevant Offsec R&D Team Agents, Offsec R&D Team determines which 
        - Target Tags include name of Client/Customer, Name, & Type

### Targets
- Operations Manager Agent 
    - Creates target (name,type,value) at the time of operation activation
    - Dispatches Task for Default Surface Assessment
- Target Reporter Agent
    - Send All New Target Data to Operations Manager
      
### Vulnerabilities
- Operations Manager Agent
  - Assigns tasks to 

- Vulnerabilities Reporter Agent

### Surface Assessment
- Operations Manager Agent
    - Trigger activates when the operation is submited, switched to "Active" and "Active is confirmed by human operator.
- Surface Assessment Reporter Agent
    - Takes json output of BBOT,Nuclei and NMAP  

#### Overview Section

Replace the two elements that say "Most Vulnerable Assets" & "Recent Activity" and in that space create an element to upload a burpsuite pro .jar file which will embed BurpSuite Pro into the app.


```
// Find the sections to replace by their headings
const headings = document.querySelectorAll('h3, h2, h1');
let mostVulnerableCard = null;
let recentActivityCard = null;

headings.forEach(heading => {
  const text = heading.textContent;
  if (text && text.includes('Most Vulnerable Assets')) {
    // Go up until we find the card container
    let parent = heading.parentElement;
    while (parent && !parent.className.includes('bg-card')) {
      parent = parent.parentElement;
    }
    mostVulnerableCard = parent;
  }
  if (text && text.includes('Recent Activity')) {
    // Go up until we find the card container
    let parent = heading.parentElement;
    while (parent && !parent.className.includes('bg-card')) {
      parent = parent.parentElement;
    }
    recentActivityCard = parent;
  }
});

// Get the parent container that holds both cards
const parentContainer = mostVulnerableCard ? mostVulnerableCard.parentElement : null;

// Create the new BurpSuite upload component
const burpUploadCard = document.createElement('div');
burpUploadCard.className = 'bg-card p-6 rounded-lg shadow-sm border border-border col-span-2';
burpUploadCard.innerHTML = `
  <div class="flex items-center justify-between mb-6">
    <div>
      <h3 class="text-lg font-semibold mb-2">BurpSuite Pro Integration</h3>
      <p class="text-sm text-muted-foreground">Upload BurpSuite Pro .jar file to embed into the application</p>
    </div>
  </div>
  
  <div class="space-y-4">
    <div class="border-2 border-dashed border-border rounded-lg p-8 text-center hover:border-primary transition-colors" id="burp-upload-zone">
      <svg class="mx-auto h-12 w-12 text-muted-foreground mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
      </svg>
      <div class="mb-4">
        <label for="burp-jar-input" class="cursor-pointer">
          <span class="text-primary font-medium hover:underline">Click to upload</span>
          <span class="text-muted-foreground"> or drag and drop</span>
        </label>
        <input type="file" id="burp-jar-input" accept=".jar" class="hidden" />
      </div>
      <p class="text-xs text-muted-foreground">JAR files only (BurpSuite Pro)</p>
    </div>
    
    <div id="burp-upload-status" class="hidden">
      <div class="flex items-center p-4 bg-secondary rounded-lg">
        <svg class="h-5 w-5 text-primary mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <div class="flex-1">
          <p class="text-sm font-medium" id="burp-filename">No file selected</p>
          <p class="text-xs text-muted-foreground" id="burp-filesize"></p>
        </div>
        <button class="ml-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors" id="burp-embed-btn">
          Embed BurpSuite
        </button>
      </div>
    </div>
    
    <div id="burp-progress" class="hidden">
      <div class="w-full bg-secondary rounded-full h-2">
        <div class="bg-primary h-2 rounded-full transition-all" style="width: 0%" id="burp-progress-bar"></div>
      </div>
      <p class="text-xs text-muted-foreground mt-2 text-center" id="burp-progress-text">Processing...</p>
    </div>
  </div>
`;

// Remove the old sections and insert the new component
if (mostVulnerableCard && recentActivityCard && parentContainer) {
  // Insert the new card before removing old ones
  mostVulnerableCard.parentElement.insertBefore(burpUploadCard, mostVulnerableCard);
  
  // Remove old sections
  mostVulnerableCard.remove();
  recentActivityCard.remove();
  
  // Add event listeners for file upload
  const fileInput = document.getElementById('burp-jar-input');
  const uploadZone = document.getElementById('burp-upload-zone');
  const statusDiv = document.getElementById('burp-upload-status');
  const filenameSpan = document.getElementById('burp-filename');
  const filesizeSpan = document.getElementById('burp-filesize');
  const embedBtn = document.getElementById('burp-embed-btn');
  const progressDiv = document.getElementById('burp-progress');
  const progressBar = document.getElementById('burp-progress-bar');
  const progressText = document.getElementById('burp-progress-text');
  
  let selectedFile = null;
  
  // File input change handler
  fileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file && file.name.endsWith('.jar')) {
      selectedFile = file;
      filenameSpan.textContent = file.name;
      filesizeSpan.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
      statusDiv.classList.remove('hidden');
      uploadZone.classList.add('hidden');
    }
  });
  
  // Drag and drop functionality
  uploadZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadZone.style.borderColor = 'var(--primary)';
  });
  
  uploadZone.addEventListener('dragleave', (e) => {
    e.preventDefault();
    uploadZone.style.borderColor = '';
  });
  
  uploadZone.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadZone.style.borderColor = '';
    const file = e.dataTransfer.files[0];
    if (file && file.name.endsWith('.jar')) {
      selectedFile = file;
      filenameSpan.textContent = file.name;
      filesizeSpan.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
      statusDiv.classList.remove('hidden');
      uploadZone.classList.add('hidden');
    }
  });
  
  // Embed button click handler
  embedBtn.addEventListener('click', () => {
    if (selectedFile) {
      statusDiv.classList.add('hidden');
      progressDiv.classList.remove('hidden');
      
      // Simulate upload progress (replace with actual upload logic)
      let progress = 0;
      const interval = setInterval(() => {
        progress += 10;
        progressBar.style.width = progress + '%';
        progressText.textContent = `Embedding BurpSuite Pro... ${progress}%`;
        
        if (progress >= 100) {
          clearInterval(interval);
          progressText.textContent = 'BurpSuite Pro embedded successfully!';
          
          // TODO: Add your actual file upload/embedding logic here
          // Example: Send file to backend endpoint
          // const formData = new FormData();
          // formData.append('burpsuite', selectedFile);
          // fetch('/api/embed-burpsuite', { method: 'POST', body: formData });
          
          setTimeout(() => {
            // Reset to initial state
            progressDiv.classList.add('hidden');
            uploadZone.classList.remove('hidden');
            fileInput.value = '';
            selectedFile = null;
            progressBar.style.width = '0%';
          }, 2000);
        }
      }, 300);
    }
  });
}

console.log('BurpSuite upload component created successfully');
```

#### Vulnerabilities
- [New Workflow] Shodan-CVE to Nuclei 
  - If there are any potential Shodan CVE's returned from a BBOT Scan, the Vulnerabilities Reporter Agent will send the information to the Operations Management Agent, 
  
  - The Operations Manager will dispatch a task to the Surface Assessment Agent to execute a corresponding Nuclei Template. 
  
    - If a Template cannot be found, send the CVE Vulnerability to the R&D Team to develop a functional Nuclei Template to attempt to validate the CVE presence

#### Assets
#### Services
#### Topology

The goal is to uses data collected from JSON files throughout an operation to construct and 3D toplogogy from Top (Public Facing Assets) to bottom (internal descending subnets)

This will utilize BBOT, Nuclei and Bloodhound data

  - The goal is to create a live network topology mapping for each operation


[Use this repo-fork](https://github.com/cmndcntrlcyber/3d-force-graph)
[And this repo-fork](https://github.com/cmndcntrlcyber/networkmaps)

#### Activity
#### Scan Config

- Operations Manager Agent
- Reporter Agent

### Reports
- Remove current reporting capabilities
- Deploy and embed [Sysreptor](https://docs.sysreptor.com/setup/configuration/)
  - Incorporate [AI AGents](https://docs.sysreptor.com/setup/configuration/#ai-agent), [OLLAMA LLM Provider](https://docs.sysreptor.com/setup/configuration/#llm-provider),
  - Equipt the Technical Writer Agent with all the capabilities of utilising the sysreptor [CLI](https://docs.sysreptor.com/cli/getting-started/) and [python library](https://docs.sysreptor.com/python-library/)

- Operations Manager Agent
- Technical Writer Agent
- Reporter Agent

# AI

- Operations Manager Agent
- Reporter Agent

## Ollama AI

- Operations Manager Agent
- Reporter Agent

# Offsec R&D Team

## ATT&CK Workflows
## Research Projects
## Experiments
## Tool Lab
## Knowledge Base
- Link knowledge base to 

# Frameworks
__1. For each framework and its variants,create an agent__

__2. For each framework and their agents, create docker containers that contain within them all the scripts and tools necessary to evaluate enterprises against all vulnerabilities and hardening requirements.__


- Review the files in ./framework/ and develop an app page interface capable of executing all techniques delivered through the rust-nexus agent

- Update the plan files in rust-nexus-enhancement when critically necessary to facilitate secure agentic testing of LLM and Adversarial AI/ML capabilities. 

## MITRE
- Operations Manager Agent
    -
- Reporter Agent
    - 

### ATT&CK
- Move Tactic Agent List to First Tab
- Stix Upload Tile
    - Make Single-Click instead of Double for Upload
    - Automatically push STIX Data Upload to ATT&CK Workbench DB
#### Planner
https://github.com/cmndcntrlcyber/attck-planner
###### **Features**
- **Threat Actor Lookup:** Retrieve known MITRE ATT&CK techniques used by a specified adversary.
- **Impact Selection:** Choose a desired impact (e.g., Data Exfiltration, Credential Theft, System Disruption).
- **AI-Powered Plan Generation:** Leverage Research Agent to generate emulation plans.
- **Real-Time Threat Intelligence:** Integrated with Tavily MCP for up-to-date threat intelligence and context enrichment. Utilizes ATT&CK STIX Collection data to drive research.
- **User-Friendly Interface:** Built with Streamlit for quick and easy interaction.
- **Customizable API Parameters:** Modify model-specific settings to fine-tune responses.


#### Workbench 
- Split the space so that the "ATT&CK Workbewnch Connection" is on the left and "Bydirectional Sync" on the right
- Embed the Workbench Frontend containerwithin the remaining space below
##### Frontend
- Ensure it is enabled in the @./docker-compose.yml line 151 by default

#### Navigator [Acceptable]
#### Flow Builder 
 - Remove Flow Builder Label, Place Attack Flow in that element
    - [Utilize this project to embed as the Flow Builder](https://center-for-threat-informed-defense.github.io/attack-flow/builder/#:~:text=Alternatively%2C%20you%20can%20run%20the%20Attack%20Flow%20Builder%20with%20Docker%20Compose%3A)

#### Techniques [Acceptable]

#### Tactics [Acceptable]

#### Groups [Acceptable]

#### Software [Acceptable]

#### Mitigations [Acceptable]

### ATLAS
[Provide the Exact Same Structure as ATT&CK]
Utilize [this file](docs/enhancements/2.3/framework/Atlas_Matrix.json) for the Matrix Tactics.

## OWASP
### OWASP LLM Top 10
[Use this file](docs/enhancements/2.3/framework/LLMAll_en-US_FINAL.pdf) as a basis for a more target-agnostic implementation

Adapt the files in `/home/cmndcntrl/code/llm top 10/`to facilitate a target-agnostic framework


## NIST
### NIST AI RMF
Please create a testing framework based on [this document](docs/enhancements/2.3/framework/NIST.AI.100-1.pdf)

## CIS

[Pending]

# RTPI Tools

## Issue Resolution: Tool Discovery Failure (FIXED)

**Root Cause:** The Tool Connector Agent was calling `DockerExecutor.exec()` with incorrect parameters - passing the command string where the container name should be, causing all tool discovery to fail silently.

**Fix Applied:**
1. Fixed `DockerExecutor.exec()` calls to use correct signature: `exec(containerName, cmdArray, options)`
2. Added multi-container discovery support (polls 8 containers instead of just 1)
3. Added container tracking in tool registry database

## Architecture Overview

```
Tool Discovery System (IMPLEMENTED)
├── Tool Connector Agent (server/services/agents/tool-connector-agent.ts)
│   ├── Polls all containers every 5 minutes
│   ├── Runs `which <tool> && <tool> --version` in containers
│   └── Syncs discovered tools to toolRegistry database with container info
│
├── Multi-Container Executor (server/services/agents/multi-container-executor.ts)
│   ├── Routes tool execution to correct container automatically
│   ├── Caches tool registry lookups for performance
│   └── Provides streaming execution support
│
├── Primary Container: rtpi-tools
│   └── General tools: nmap, bbot, nuclei, metasploit, gobuster, hydra
│
└── OffSec Agent Containers (start by default with docker compose up -d)
    ├── rtpi-maldev-agent    → Reverse engineering, ROP, binary analysis (44 tools)
    ├── rtpi-azure-ad-agent  → Azure/EntraID attack tools (28 tools)
    ├── rtpi-burp-agent      → Web security, proxy tools (15+ tools)
    ├── rtpi-empire-agent    → C2 frameworks, payloads (8+ tools)
    ├── rtpi-fuzzing-agent   → FFUF, Gobuster, Feroxbuster (8+ tools)
    ├── rtpi-framework-agent → WhatWeb, WPScan, CMS scanners (10+ tools)
    └── rtpi-research-agent  → Comprehensive R&D toolset + JupyterLab
```

## Deployment Checklist

### Step 1: Build Tool Images
```bash
# Build all containers (primary tools + all OffSec agents)
docker compose build
```

### Step 2: Start Containers
```bash
# Start all containers (OffSec agents now start by default)
docker compose up -d
```

### Step 3: Verify Tool Installation
```bash
# Check rtpi-tools
docker exec rtpi-tools which nmap bbot nuclei

# Check OffSec agents
docker exec rtpi-fuzzing-agent which ffuf gobuster
docker exec rtpi-maldev-agent which radare2 objdump
```

### Step 4: Trigger Tool Discovery
```bash
curl -X POST http://localhost:3001/api/v1/agents/tool-connector/poll
```

### Step 5: Verify Discovery Status
```bash
curl http://localhost:3001/api/v1/agents/tool-connector/status
# Expected: { "discoveredToolsCount": 20+, "lastPoll": "..." }
```

## API Endpoints (NEW)

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/v1/tools/execute` | POST | Execute any registered tool by name (auto-routes to container) |
| `/api/v1/tools/containers/status` | GET | Get running status of all tool containers |
| `/api/v1/tools/by-container` | GET | Get tools grouped by container |
| `/api/v1/tools/lookup/:toolName` | GET | Lookup tool info and container location |

### Example: Execute nmap
```bash
curl -X POST http://localhost:3001/api/v1/tools/execute \
  -H "Content-Type: application/json" \
  -d '{"tool": "nmap", "args": ["-V"]}'
```

## Tool Containers Reference

| Container | Dockerfile | Tools | Purpose |
|-----------|-----------|-------|---------|
| rtpi-tools | Dockerfile.tools | nmap, bbot, nuclei, metasploit, gobuster, hydra | General reconnaissance & exploitation |
| rtpi-maldev-agent | docker/offsec-agents/Dockerfile.maldev-tools | radare2, ghidra, pwntools, ROPgadget | Binary analysis & exploit development |
| rtpi-azure-ad-agent | docker/offsec-agents/Dockerfile.azure-ad-tools | AADInternals, ROADtools, AzureHound | Azure/AD attack research |
| rtpi-burp-agent | docker/offsec-agents/Dockerfile.burp-tools | Burp extensions, crawlers, proxies | Web application security |
| rtpi-empire-agent | docker/offsec-agents/Dockerfile.empire-tools | Empire, Covenant, Sliver, Havoc | C2 framework management |
| rtpi-fuzzing-agent | docker/offsec-agents/Dockerfile.fuzzing-tools | ffuf, gobuster, feroxbuster, dirsearch | Web fuzzing & directory discovery |
| rtpi-framework-agent | docker/offsec-agents/Dockerfile.framework-tools | WhatWeb, Wappalyzer, WPScan | Tech detection & CMS scanning |
| rtpi-research-agent | docker/offsec-agents/Dockerfile.research-tools | All categories + JupyterLab | General R&D & POC creation |

## Files Modified

| File | Changes |
|------|---------|
| `server/services/agents/tool-connector-agent.ts` | Fixed exec() calls, added multi-container polling |
| `server/services/agents/multi-container-executor.ts` | NEW: Routes tool execution to correct container |
| `shared/schema.ts` | Added containerName, containerUser columns to toolRegistry |
| `server/api/v1/tools.ts` | Added multi-container execution endpoints |

## Tool Registry Reporter Agent Workflow

1. **GitHub Repository Input:** User provides repository URL
2. **Staging Container:** Clone to `~/` in staging container
3. **Auto-Deployment:** Tool-Registry Reporter Agent reads README, follows install instructions, debugs until operational
4. **Documentation:** Generates troubleshooting docs, saves to `docs/troubleshooting/`
5. **Migration:** Tool-Validator Agent verifies and migrates to production container

## Tools Migration Pipeline

```
GitHub Repo → Staging Container → Reporter Agent → Troubleshooting Docs → Validator Agent → Production Container → Tool Registry
``` 

# Infrastructure

## Infrastructure Monitoring

#### Rust-Nexus Teamserver

#### Rust-Nexus (Client) (Docker Container)

#### Agentic Implants (Rust-Nexus Agents)

      - Feature: Create Delete Agent Bundles


# Administration
    
## User Management

## Profile

## Settings



