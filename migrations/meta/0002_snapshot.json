{
  "id": "5b0a10a3-6a7e-44eb-b1df-ce1d45ace22c",
  "prevId": "42ede41b-cbce-44d1-ba10-0c76f3e1e465",
  "version": "7",
  "dialect": "postgresql",
  "tables": {
    "public.agent_activity_reports": {
      "name": "agent_activity_reports",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "agent_id": {
          "name": "agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "agent_page_role": {
          "name": "agent_page_role",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "target_id": {
          "name": "target_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "report_type": {
          "name": "report_type",
          "type": "report_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'hourly_status'"
        },
        "report_period_start": {
          "name": "report_period_start",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "report_period_end": {
          "name": "report_period_end",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "activity_summary": {
          "name": "activity_summary",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "key_metrics": {
          "name": "key_metrics",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "page_state": {
          "name": "page_state",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "changes_detected": {
          "name": "changes_detected",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "issues_reported": {
          "name": "issues_reported",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "recommendations": {
          "name": "recommendations",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'submitted'"
        },
        "generated_at": {
          "name": "generated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "reviewed_at": {
          "name": "reviewed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "agent_activity_reports_agent_id_agents_id_fk": {
          "name": "agent_activity_reports_agent_id_agents_id_fk",
          "tableFrom": "agent_activity_reports",
          "tableTo": "agents",
          "columnsFrom": [
            "agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "agent_activity_reports_operation_id_operations_id_fk": {
          "name": "agent_activity_reports_operation_id_operations_id_fk",
          "tableFrom": "agent_activity_reports",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "agent_activity_reports_target_id_targets_id_fk": {
          "name": "agent_activity_reports_target_id_targets_id_fk",
          "tableFrom": "agent_activity_reports",
          "tableTo": "targets",
          "columnsFrom": [
            "target_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.agent_builds": {
      "name": "agent_builds",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "status": {
          "name": "status",
          "type": "agent_build_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "platform": {
          "name": "platform",
          "type": "agent_platform",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "architecture": {
          "name": "architecture",
          "type": "agent_architecture",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'x64'"
        },
        "features": {
          "name": "features",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "binary_path": {
          "name": "binary_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "binary_size": {
          "name": "binary_size",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "binary_hash": {
          "name": "binary_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "build_log": {
          "name": "build_log",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "build_duration_ms": {
          "name": "build_duration_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "agent_builds_created_by_users_id_fk": {
          "name": "agent_builds_created_by_users_id_fk",
          "tableFrom": "agent_builds",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.agent_bundles": {
      "name": "agent_bundles",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "platform": {
          "name": "platform",
          "type": "agent_platform",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "architecture": {
          "name": "architecture",
          "type": "agent_architecture",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'x64'"
        },
        "build_id": {
          "name": "build_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "certificate_id": {
          "name": "certificate_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "certificate_serial": {
          "name": "certificate_serial",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "certificate_fingerprint": {
          "name": "certificate_fingerprint",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "file_path": {
          "name": "file_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "file_size": {
          "name": "file_size",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "file_hash": {
          "name": "file_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "controller_url": {
          "name": "controller_url",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "implant_type": {
          "name": "implant_type",
          "type": "implant_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false,
          "default": "'general'"
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "download_count": {
          "name": "download_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "agent_bundles_build_id_agent_builds_id_fk": {
          "name": "agent_bundles_build_id_agent_builds_id_fk",
          "tableFrom": "agent_bundles",
          "tableTo": "agent_builds",
          "columnsFrom": [
            "build_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "agent_bundles_certificate_id_rust_nexus_certificates_id_fk": {
          "name": "agent_bundles_certificate_id_rust_nexus_certificates_id_fk",
          "tableFrom": "agent_bundles",
          "tableTo": "rust_nexus_certificates",
          "columnsFrom": [
            "certificate_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "agent_bundles_created_by_users_id_fk": {
          "name": "agent_bundles_created_by_users_id_fk",
          "tableFrom": "agent_bundles",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.agent_download_tokens": {
      "name": "agent_download_tokens",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "token": {
          "name": "token",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "bundle_id": {
          "name": "bundle_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "max_downloads": {
          "name": "max_downloads",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 1
        },
        "current_downloads": {
          "name": "current_downloads",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "allowed_ip_ranges": {
          "name": "allowed_ip_ranges",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "last_used_at": {
          "name": "last_used_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "revoked_at": {
          "name": "revoked_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "revoked_by": {
          "name": "revoked_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "agent_download_tokens_bundle_id_agent_bundles_id_fk": {
          "name": "agent_download_tokens_bundle_id_agent_bundles_id_fk",
          "tableFrom": "agent_download_tokens",
          "tableTo": "agent_bundles",
          "columnsFrom": [
            "bundle_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "agent_download_tokens_created_by_users_id_fk": {
          "name": "agent_download_tokens_created_by_users_id_fk",
          "tableFrom": "agent_download_tokens",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "agent_download_tokens_revoked_by_users_id_fk": {
          "name": "agent_download_tokens_revoked_by_users_id_fk",
          "tableFrom": "agent_download_tokens",
          "tableTo": "users",
          "columnsFrom": [
            "revoked_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "agent_download_tokens_token_unique": {
          "name": "agent_download_tokens_token_unique",
          "nullsNotDistinct": false,
          "columns": [
            "token"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.agent_workflows": {
      "name": "agent_workflows",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "workflow_type": {
          "name": "workflow_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "target_id": {
          "name": "target_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "current_agent_id": {
          "name": "current_agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "current_task_id": {
          "name": "current_task_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "workflow_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "progress": {
          "name": "progress",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "agent_workflows_target_id_targets_id_fk": {
          "name": "agent_workflows_target_id_targets_id_fk",
          "tableFrom": "agent_workflows",
          "tableTo": "targets",
          "columnsFrom": [
            "target_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "agent_workflows_operation_id_operations_id_fk": {
          "name": "agent_workflows_operation_id_operations_id_fk",
          "tableFrom": "agent_workflows",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "agent_workflows_current_agent_id_agents_id_fk": {
          "name": "agent_workflows_current_agent_id_agents_id_fk",
          "tableFrom": "agent_workflows",
          "tableTo": "agents",
          "columnsFrom": [
            "current_agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "agent_workflows_created_by_users_id_fk": {
          "name": "agent_workflows_created_by_users_id_fk",
          "tableFrom": "agent_workflows",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.agents": {
      "name": "agents",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "type": {
          "name": "type",
          "type": "agent_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "agent_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'idle'"
        },
        "config": {
          "name": "config",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "capabilities": {
          "name": "capabilities",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "last_activity": {
          "name": "last_activity",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "tasks_completed": {
          "name": "tasks_completed",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "tasks_failed": {
          "name": "tasks_failed",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ai_enrichment_logs": {
      "name": "ai_enrichment_logs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "vulnerability_id": {
          "name": "vulnerability_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "model_used": {
          "name": "model_used",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "provider": {
          "name": "provider",
          "type": "ai_provider",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'ollama'"
        },
        "enrichment_type": {
          "name": "enrichment_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "prompt": {
          "name": "prompt",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "response": {
          "name": "response",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "tokens_used": {
          "name": "tokens_used",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "prompt_tokens": {
          "name": "prompt_tokens",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "completion_tokens": {
          "name": "completion_tokens",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "duration_ms": {
          "name": "duration_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "temperature": {
          "name": "temperature",
          "type": "real",
          "primaryKey": false,
          "notNull": false,
          "default": 0.7
        },
        "max_tokens": {
          "name": "max_tokens",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "success": {
          "name": "success",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "ai_enrichment_logs_vulnerability_id_vulnerabilities_id_fk": {
          "name": "ai_enrichment_logs_vulnerability_id_vulnerabilities_id_fk",
          "tableFrom": "ai_enrichment_logs",
          "tableTo": "vulnerabilities",
          "columnsFrom": [
            "vulnerability_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.api_keys": {
      "name": "api_keys",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "key_hash": {
          "name": "key_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "permissions": {
          "name": "permissions",
          "type": "json",
          "primaryKey": false,
          "notNull": true,
          "default": "'[]'::json"
        },
        "rate_limit": {
          "name": "rate_limit",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 100
        },
        "last_used": {
          "name": "last_used",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "api_keys_user_id_users_id_fk": {
          "name": "api_keys_user_id_users_id_fk",
          "tableFrom": "api_keys",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "api_keys_key_hash_unique": {
          "name": "api_keys_key_hash_unique",
          "nullsNotDistinct": false,
          "columns": [
            "key_hash"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.asset_questions": {
      "name": "asset_questions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "asset_id": {
          "name": "asset_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "question": {
          "name": "question",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "question_type": {
          "name": "question_type",
          "type": "question_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "asked_by": {
          "name": "asked_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "answer": {
          "name": "answer",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "answer_source": {
          "name": "answer_source",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "answered_by_user_id": {
          "name": "answered_by_user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "answered_by_agent_id": {
          "name": "answered_by_agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "evidence": {
          "name": "evidence",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "confidence": {
          "name": "confidence",
          "type": "real",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "question_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "follow_up_questions": {
          "name": "follow_up_questions",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "asked_at": {
          "name": "asked_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "answered_at": {
          "name": "answered_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "reviewed_at": {
          "name": "reviewed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "user_feedback": {
          "name": "user_feedback",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "helpful": {
          "name": "helpful",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "asset_questions_asset_id_discovered_assets_id_fk": {
          "name": "asset_questions_asset_id_discovered_assets_id_fk",
          "tableFrom": "asset_questions",
          "tableTo": "discovered_assets",
          "columnsFrom": [
            "asset_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "asset_questions_operation_id_operations_id_fk": {
          "name": "asset_questions_operation_id_operations_id_fk",
          "tableFrom": "asset_questions",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "asset_questions_asked_by_agents_id_fk": {
          "name": "asset_questions_asked_by_agents_id_fk",
          "tableFrom": "asset_questions",
          "tableTo": "agents",
          "columnsFrom": [
            "asked_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "asset_questions_answered_by_user_id_users_id_fk": {
          "name": "asset_questions_answered_by_user_id_users_id_fk",
          "tableFrom": "asset_questions",
          "tableTo": "users",
          "columnsFrom": [
            "answered_by_user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "asset_questions_answered_by_agent_id_agents_id_fk": {
          "name": "asset_questions_answered_by_agent_id_agents_id_fk",
          "tableFrom": "asset_questions",
          "tableTo": "agents",
          "columnsFrom": [
            "answered_by_agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_campaigns": {
      "name": "attack_campaigns",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "attack_id": {
          "name": "attack_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "aliases": {
          "name": "aliases",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "first_seen": {
          "name": "first_seen",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "last_seen": {
          "name": "last_seen",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "external_references": {
          "name": "external_references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "x_mitre_version": {
          "name": "x_mitre_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_first_seen_citation": {
          "name": "x_mitre_first_seen_citation",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_last_seen_citation": {
          "name": "x_mitre_last_seen_citation",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_campaigns_attack_id_unique": {
          "name": "attack_campaigns_attack_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "attack_id"
          ]
        },
        "attack_campaigns_stix_id_unique": {
          "name": "attack_campaigns_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_data_sources": {
      "name": "attack_data_sources",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "attack_id": {
          "name": "attack_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "platforms": {
          "name": "platforms",
          "type": "attack_platform[]",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false
        },
        "collection_layers": {
          "name": "collection_layers",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "data_components": {
          "name": "data_components",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "external_references": {
          "name": "external_references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "x_mitre_version": {
          "name": "x_mitre_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_data_sources_attack_id_unique": {
          "name": "attack_data_sources_attack_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "attack_id"
          ]
        },
        "attack_data_sources_stix_id_unique": {
          "name": "attack_data_sources_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_groups": {
      "name": "attack_groups",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "attack_id": {
          "name": "attack_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "aliases": {
          "name": "aliases",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "deprecated": {
          "name": "deprecated",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "revoked": {
          "name": "revoked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "external_references": {
          "name": "external_references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "x_mitre_version": {
          "name": "x_mitre_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_contributors": {
          "name": "x_mitre_contributors",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_groups_attack_id_unique": {
          "name": "attack_groups_attack_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "attack_id"
          ]
        },
        "attack_groups_stix_id_unique": {
          "name": "attack_groups_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_mitigations": {
      "name": "attack_mitigations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "attack_id": {
          "name": "attack_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "deprecated": {
          "name": "deprecated",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "revoked": {
          "name": "revoked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "external_references": {
          "name": "external_references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "x_mitre_version": {
          "name": "x_mitre_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_mitigations_attack_id_unique": {
          "name": "attack_mitigations_attack_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "attack_id"
          ]
        },
        "attack_mitigations_stix_id_unique": {
          "name": "attack_mitigations_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_relationships": {
      "name": "attack_relationships",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "relationship_type": {
          "name": "relationship_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "source_type": {
          "name": "source_type",
          "type": "attack_object_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "source_ref": {
          "name": "source_ref",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "target_type": {
          "name": "target_type",
          "type": "attack_object_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "target_ref": {
          "name": "target_ref",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_relationships_stix_id_unique": {
          "name": "attack_relationships_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_software": {
      "name": "attack_software",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "attack_id": {
          "name": "attack_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "software_type": {
          "name": "software_type",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "aliases": {
          "name": "aliases",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "platforms": {
          "name": "platforms",
          "type": "attack_platform[]",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "deprecated": {
          "name": "deprecated",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "revoked": {
          "name": "revoked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "external_references": {
          "name": "external_references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "x_mitre_version": {
          "name": "x_mitre_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_contributors": {
          "name": "x_mitre_contributors",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_platforms": {
          "name": "x_mitre_platforms",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_software_attack_id_unique": {
          "name": "attack_software_attack_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "attack_id"
          ]
        },
        "attack_software_stix_id_unique": {
          "name": "attack_software_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_tactics": {
      "name": "attack_tactics",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "attack_id": {
          "name": "attack_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "short_name": {
          "name": "short_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_shortname": {
          "name": "x_mitre_shortname",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_tactics_attack_id_unique": {
          "name": "attack_tactics_attack_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "attack_id"
          ]
        },
        "attack_tactics_stix_id_unique": {
          "name": "attack_tactics_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_technique_tactics": {
      "name": "attack_technique_tactics",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "technique_id": {
          "name": "technique_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "tactic_id": {
          "name": "tactic_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "attack_technique_tactics_technique_id_attack_techniques_id_fk": {
          "name": "attack_technique_tactics_technique_id_attack_techniques_id_fk",
          "tableFrom": "attack_technique_tactics",
          "tableTo": "attack_techniques",
          "columnsFrom": [
            "technique_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "attack_technique_tactics_tactic_id_attack_tactics_id_fk": {
          "name": "attack_technique_tactics_tactic_id_attack_tactics_id_fk",
          "tableFrom": "attack_technique_tactics",
          "tableTo": "attack_tactics",
          "columnsFrom": [
            "tactic_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.attack_techniques": {
      "name": "attack_techniques",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "attack_id": {
          "name": "attack_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_subtechnique": {
          "name": "is_subtechnique",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "parent_technique_id": {
          "name": "parent_technique_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "stix_id": {
          "name": "stix_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "kill_chain_phases": {
          "name": "kill_chain_phases",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "platforms": {
          "name": "platforms",
          "type": "attack_platform[]",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false
        },
        "permissions_required": {
          "name": "permissions_required",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "effective_permissions": {
          "name": "effective_permissions",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "defense_bypassed": {
          "name": "defense_bypassed",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "data_sources": {
          "name": "data_sources",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "detection": {
          "name": "detection",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "modified": {
          "name": "modified",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "deprecated": {
          "name": "deprecated",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "revoked": {
          "name": "revoked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "external_references": {
          "name": "external_references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "x_mitre_version": {
          "name": "x_mitre_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_detection": {
          "name": "x_mitre_detection",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_data_sources": {
          "name": "x_mitre_data_sources",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_contributors": {
          "name": "x_mitre_contributors",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_platforms": {
          "name": "x_mitre_platforms",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "x_mitre_is_subtechnique": {
          "name": "x_mitre_is_subtechnique",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "x_mitre_impact_type": {
          "name": "x_mitre_impact_type",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "attack_techniques_parent_technique_id_attack_techniques_id_fk": {
          "name": "attack_techniques_parent_technique_id_attack_techniques_id_fk",
          "tableFrom": "attack_techniques",
          "tableTo": "attack_techniques",
          "columnsFrom": [
            "parent_technique_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "attack_techniques_attack_id_unique": {
          "name": "attack_techniques_attack_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "attack_id"
          ]
        },
        "attack_techniques_stix_id_unique": {
          "name": "attack_techniques_stix_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "stix_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.audit_logs": {
      "name": "audit_logs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "action": {
          "name": "action",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "resource": {
          "name": "resource",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "resource_id": {
          "name": "resource_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "details": {
          "name": "details",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "ip_address": {
          "name": "ip_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "user_agent": {
          "name": "user_agent",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "success": {
          "name": "success",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "timestamp": {
          "name": "timestamp",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "audit_logs_user_id_users_id_fk": {
          "name": "audit_logs_user_id_users_id_fk",
          "tableFrom": "audit_logs",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ax_module_configs": {
      "name": "ax_module_configs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "module_name": {
          "name": "module_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "enabled": {
          "name": "enabled",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "config": {
          "name": "config",
          "type": "json",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::json"
        },
        "credentials": {
          "name": "credentials",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "rate_limit": {
          "name": "rate_limit",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "timeout": {
          "name": "timeout",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 1800000
        },
        "last_used": {
          "name": "last_used",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "ax_module_configs_module_name_unique": {
          "name": "ax_module_configs_module_name_unique",
          "nullsNotDistinct": false,
          "columns": [
            "module_name"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ax_scan_results": {
      "name": "ax_scan_results",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "tool_name": {
          "name": "tool_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "scan_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "targets": {
          "name": "targets",
          "type": "json",
          "primaryKey": false,
          "notNull": true
        },
        "config": {
          "name": "config",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "results": {
          "name": "results",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "assets_found": {
          "name": "assets_found",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "services_found": {
          "name": "services_found",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "vulnerabilities_found": {
          "name": "vulnerabilities_found",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "duration": {
          "name": "duration",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "ax_scan_results_operation_id_operations_id_fk": {
          "name": "ax_scan_results_operation_id_operations_id_fk",
          "tableFrom": "ax_scan_results",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "ax_scan_results_created_by_users_id_fk": {
          "name": "ax_scan_results_created_by_users_id_fk",
          "tableFrom": "ax_scan_results",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.certificates": {
      "name": "certificates",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "device_id": {
          "name": "device_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "fingerprint": {
          "name": "fingerprint",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "subject": {
          "name": "subject",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "issuer": {
          "name": "issuer",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "serial_number": {
          "name": "serial_number",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "valid_from": {
          "name": "valid_from",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "valid_to": {
          "name": "valid_to",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "is_revoked": {
          "name": "is_revoked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "revoked_at": {
          "name": "revoked_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "certificates_device_id_devices_id_fk": {
          "name": "certificates_device_id_devices_id_fk",
          "tableFrom": "certificates",
          "tableTo": "devices",
          "columnsFrom": [
            "device_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "certificates_fingerprint_unique": {
          "name": "certificates_fingerprint_unique",
          "nullsNotDistinct": false,
          "columns": [
            "fingerprint"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.containers": {
      "name": "containers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "container_id": {
          "name": "container_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "image": {
          "name": "image",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "container_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "ports": {
          "name": "ports",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "environment": {
          "name": "environment",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "created": {
          "name": "created",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "started": {
          "name": "started",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "last_checked": {
          "name": "last_checked",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "containers_container_id_unique": {
          "name": "containers_container_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "container_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.devices": {
      "name": "devices",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "device_id": {
          "name": "device_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "certificate_fingerprint": {
          "name": "certificate_fingerprint",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "is_blocked": {
          "name": "is_blocked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "last_seen": {
          "name": "last_seen",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "ip_address": {
          "name": "ip_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "devices_device_id_unique": {
          "name": "devices_device_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "device_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.discovered_assets": {
      "name": "discovered_assets",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "surface_assessment_id": {
          "name": "surface_assessment_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "type": {
          "name": "type",
          "type": "asset_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "value": {
          "name": "value",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "hostname": {
          "name": "hostname",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ip_address": {
          "name": "ip_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "asset_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "discovery_method": {
          "name": "discovery_method",
          "type": "discovery_method",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "operating_system": {
          "name": "operating_system",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "tags": {
          "name": "tags",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "discovered_at": {
          "name": "discovered_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "last_seen_at": {
          "name": "last_seen_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "discovered_assets_surface_assessment_id_surface_assessments_id_fk": {
          "name": "discovered_assets_surface_assessment_id_surface_assessments_id_fk",
          "tableFrom": "discovered_assets",
          "tableTo": "surface_assessments",
          "columnsFrom": [
            "surface_assessment_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "discovered_assets_operation_id_operations_id_fk": {
          "name": "discovered_assets_operation_id_operations_id_fk",
          "tableFrom": "discovered_assets",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.discovered_services": {
      "name": "discovered_services",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "asset_id": {
          "name": "asset_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "port": {
          "name": "port",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "protocol": {
          "name": "protocol",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'tcp'"
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "banner": {
          "name": "banner",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "state": {
          "name": "state",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'open'"
        },
        "discovery_method": {
          "name": "discovery_method",
          "type": "discovery_method",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "discovered_at": {
          "name": "discovered_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "discovered_services_asset_id_discovered_assets_id_fk": {
          "name": "discovered_services_asset_id_discovered_assets_id_fk",
          "tableFrom": "discovered_services",
          "tableTo": "discovered_assets",
          "columnsFrom": [
            "asset_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_agents": {
      "name": "empire_agents",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "listener_id": {
          "name": "listener_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "target_id": {
          "name": "target_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "empire_agent_id": {
          "name": "empire_agent_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "session_id": {
          "name": "session_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "hostname": {
          "name": "hostname",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "internal_ip": {
          "name": "internal_ip",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "external_ip": {
          "name": "external_ip",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "username": {
          "name": "username",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "high_integrity": {
          "name": "high_integrity",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "process_name": {
          "name": "process_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "process_id": {
          "name": "process_id",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "language": {
          "name": "language",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "language_version": {
          "name": "language_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "os_details": {
          "name": "os_details",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "architecture": {
          "name": "architecture",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "domain": {
          "name": "domain",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "empire_agent_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false,
          "default": "'pending'"
        },
        "checkin_time": {
          "name": "checkin_time",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "lastseen_time": {
          "name": "lastseen_time",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "delay": {
          "name": "delay",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 5
        },
        "jitter": {
          "name": "jitter",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "lost_limit": {
          "name": "lost_limit",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 60
        },
        "kill_date": {
          "name": "kill_date",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "working_hours": {
          "name": "working_hours",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "session_key": {
          "name": "session_key",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "nonce": {
          "name": "nonce",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_agents_server_id_empire_servers_id_fk": {
          "name": "empire_agents_server_id_empire_servers_id_fk",
          "tableFrom": "empire_agents",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_agents_listener_id_empire_listeners_id_fk": {
          "name": "empire_agents_listener_id_empire_listeners_id_fk",
          "tableFrom": "empire_agents",
          "tableTo": "empire_listeners",
          "columnsFrom": [
            "listener_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "empire_agents_target_id_targets_id_fk": {
          "name": "empire_agents_target_id_targets_id_fk",
          "tableFrom": "empire_agents",
          "tableTo": "targets",
          "columnsFrom": [
            "target_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "empire_agents_operation_id_operations_id_fk": {
          "name": "empire_agents_operation_id_operations_id_fk",
          "tableFrom": "empire_agents",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_credentials": {
      "name": "empire_credentials",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "agent_id": {
          "name": "agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "empire_credential_id": {
          "name": "empire_credential_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "cred_type": {
          "name": "cred_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "domain": {
          "name": "domain",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "username": {
          "name": "username",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "password": {
          "name": "password",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ntlm_hash": {
          "name": "ntlm_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "sha256_hash": {
          "name": "sha256_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "host": {
          "name": "host",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "os": {
          "name": "os",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "sid": {
          "name": "sid",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "harvested_at": {
          "name": "harvested_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_credentials_server_id_empire_servers_id_fk": {
          "name": "empire_credentials_server_id_empire_servers_id_fk",
          "tableFrom": "empire_credentials",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_credentials_agent_id_empire_agents_id_fk": {
          "name": "empire_credentials_agent_id_empire_agents_id_fk",
          "tableFrom": "empire_credentials",
          "tableTo": "empire_agents",
          "columnsFrom": [
            "agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "empire_credentials_operation_id_operations_id_fk": {
          "name": "empire_credentials_operation_id_operations_id_fk",
          "tableFrom": "empire_credentials",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_events": {
      "name": "empire_events",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "agent_id": {
          "name": "agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "event_type": {
          "name": "event_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "event_name": {
          "name": "event_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "message": {
          "name": "message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "username": {
          "name": "username",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "event_data": {
          "name": "event_data",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_events_server_id_empire_servers_id_fk": {
          "name": "empire_events_server_id_empire_servers_id_fk",
          "tableFrom": "empire_events",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_events_agent_id_empire_agents_id_fk": {
          "name": "empire_events_agent_id_empire_agents_id_fk",
          "tableFrom": "empire_events",
          "tableTo": "empire_agents",
          "columnsFrom": [
            "agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_listeners": {
      "name": "empire_listeners",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "empire_listener_id": {
          "name": "empire_listener_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "listener_type": {
          "name": "listener_type",
          "type": "empire_listener_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "listener_category": {
          "name": "listener_category",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "host": {
          "name": "host",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "port": {
          "name": "port",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "cert_path": {
          "name": "cert_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "staging_key": {
          "name": "staging_key",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "default_delay": {
          "name": "default_delay",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 5
        },
        "default_jitter": {
          "name": "default_jitter",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "default_lost_limit": {
          "name": "default_lost_limit",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 60
        },
        "kill_date": {
          "name": "kill_date",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "working_hours": {
          "name": "working_hours",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "redirect_target": {
          "name": "redirect_target",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "proxy_url": {
          "name": "proxy_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "proxy_username": {
          "name": "proxy_username",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "proxy_password": {
          "name": "proxy_password",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "user_agent": {
          "name": "user_agent",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "headers": {
          "name": "headers",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "cookie": {
          "name": "cookie",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'stopped'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "config": {
          "name": "config",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_listeners_server_id_empire_servers_id_fk": {
          "name": "empire_listeners_server_id_empire_servers_id_fk",
          "tableFrom": "empire_listeners",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_listeners_created_by_users_id_fk": {
          "name": "empire_listeners_created_by_users_id_fk",
          "tableFrom": "empire_listeners",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_modules": {
      "name": "empire_modules",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "module_name": {
          "name": "module_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "module_path": {
          "name": "module_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "language": {
          "name": "language",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "background": {
          "name": "background",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "output_extension": {
          "name": "output_extension",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "needs_admin": {
          "name": "needs_admin",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "opsec_safe": {
          "name": "opsec_safe",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "software": {
          "name": "software",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "options": {
          "name": "options",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "comments": {
          "name": "comments",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_modules_server_id_empire_servers_id_fk": {
          "name": "empire_modules_server_id_empire_servers_id_fk",
          "tableFrom": "empire_modules",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_servers": {
      "name": "empire_servers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "host": {
          "name": "host",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "port": {
          "name": "port",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 1337
        },
        "rest_api_url": {
          "name": "rest_api_url",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "rest_api_port": {
          "name": "rest_api_port",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 1337
        },
        "socketio_url": {
          "name": "socketio_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "socketio_port": {
          "name": "socketio_port",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "admin_username": {
          "name": "admin_username",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'empireadmin'"
        },
        "admin_password_hash": {
          "name": "admin_password_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "api_token": {
          "name": "api_token",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "certificate_path": {
          "name": "certificate_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'disconnected'"
        },
        "last_heartbeat": {
          "name": "last_heartbeat",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_stagers": {
      "name": "empire_stagers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "listener_id": {
          "name": "listener_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "stager_name": {
          "name": "stager_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "stager_type": {
          "name": "stager_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "language": {
          "name": "language",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "output_file": {
          "name": "output_file",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "base64_output": {
          "name": "base64_output",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "listener_name": {
          "name": "listener_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "user_agent": {
          "name": "user_agent",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "proxy_url": {
          "name": "proxy_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "proxy_credentials": {
          "name": "proxy_credentials",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "binpath": {
          "name": "binpath",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "obfuscate": {
          "name": "obfuscate",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "obfuscation_command": {
          "name": "obfuscation_command",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "bypass_amsi": {
          "name": "bypass_amsi",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "bypass_uac": {
          "name": "bypass_uac",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "config": {
          "name": "config",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_stagers_server_id_empire_servers_id_fk": {
          "name": "empire_stagers_server_id_empire_servers_id_fk",
          "tableFrom": "empire_stagers",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_stagers_listener_id_empire_listeners_id_fk": {
          "name": "empire_stagers_listener_id_empire_listeners_id_fk",
          "tableFrom": "empire_stagers",
          "tableTo": "empire_listeners",
          "columnsFrom": [
            "listener_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "empire_stagers_created_by_users_id_fk": {
          "name": "empire_stagers_created_by_users_id_fk",
          "tableFrom": "empire_stagers",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_tasks": {
      "name": "empire_tasks",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "agent_id": {
          "name": "agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "empire_task_id": {
          "name": "empire_task_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "task_name": {
          "name": "task_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "module_name": {
          "name": "module_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "command": {
          "name": "command",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "parameters": {
          "name": "parameters",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "status": {
          "name": "status",
          "type": "empire_task_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false,
          "default": "'queued'"
        },
        "results": {
          "name": "results",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "user_output": {
          "name": "user_output",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "agent_output": {
          "name": "agent_output",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "queued_at": {
          "name": "queued_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "sent_at": {
          "name": "sent_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_tasks_server_id_empire_servers_id_fk": {
          "name": "empire_tasks_server_id_empire_servers_id_fk",
          "tableFrom": "empire_tasks",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_tasks_agent_id_empire_agents_id_fk": {
          "name": "empire_tasks_agent_id_empire_agents_id_fk",
          "tableFrom": "empire_tasks",
          "tableTo": "empire_agents",
          "columnsFrom": [
            "agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_tasks_created_by_users_id_fk": {
          "name": "empire_tasks_created_by_users_id_fk",
          "tableFrom": "empire_tasks",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.empire_user_tokens": {
      "name": "empire_user_tokens",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "permanent_token": {
          "name": "permanent_token",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "temporary_token": {
          "name": "temporary_token",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "token_expires_at": {
          "name": "token_expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "last_used": {
          "name": "last_used",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "empire_user_tokens_user_id_users_id_fk": {
          "name": "empire_user_tokens_user_id_users_id_fk",
          "tableFrom": "empire_user_tokens",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "empire_user_tokens_server_id_empire_servers_id_fk": {
          "name": "empire_user_tokens_server_id_empire_servers_id_fk",
          "tableFrom": "empire_user_tokens",
          "tableTo": "empire_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.files": {
      "name": "files",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "filename": {
          "name": "filename",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "original_name": {
          "name": "original_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "mimetype": {
          "name": "mimetype",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "size": {
          "name": "size",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "path": {
          "name": "path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "uploaded_by": {
          "name": "uploaded_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "files_uploaded_by_users_id_fk": {
          "name": "files_uploaded_by_users_id_fk",
          "tableFrom": "files",
          "tableTo": "users",
          "columnsFrom": [
            "uploaded_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "files_operation_id_operations_id_fk": {
          "name": "files_operation_id_operations_id_fk",
          "tableFrom": "files",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.github_tool_installations": {
      "name": "github_tool_installations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "github_url": {
          "name": "github_url",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "tool_id": {
          "name": "tool_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "repo_name": {
          "name": "repo_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "detected_language": {
          "name": "detected_language",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "detected_dependencies": {
          "name": "detected_dependencies",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "suggested_install_method": {
          "name": "suggested_install_method",
          "type": "install_method",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false
        },
        "dockerfile_generated": {
          "name": "dockerfile_generated",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "build_script_generated": {
          "name": "build_script_generated",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "install_status": {
          "name": "install_status",
          "type": "install_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "build_log": {
          "name": "build_log",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "analyzed_at": {
          "name": "analyzed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "installed_at": {
          "name": "installed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "github_tool_installations_tool_id_tool_registry_id_fk": {
          "name": "github_tool_installations_tool_id_tool_registry_id_fk",
          "tableFrom": "github_tool_installations",
          "tableTo": "tool_registry",
          "columnsFrom": [
            "tool_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.health_checks": {
      "name": "health_checks",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "service": {
          "name": "service",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "message": {
          "name": "message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "details": {
          "name": "details",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "failure_count": {
          "name": "failure_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "last_check": {
          "name": "last_check",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "next_check": {
          "name": "next_check",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.kasm_sessions": {
      "name": "kasm_sessions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "workspace_id": {
          "name": "workspace_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "session_token": {
          "name": "session_token",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "kasm_session_id": {
          "name": "kasm_session_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_activity": {
          "name": "last_activity",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "activity_count": {
          "name": "activity_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "ip_address": {
          "name": "ip_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "user_agent": {
          "name": "user_agent",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "terminated_at": {
          "name": "terminated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "kasm_sessions_user_id_users_id_fk": {
          "name": "kasm_sessions_user_id_users_id_fk",
          "tableFrom": "kasm_sessions",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "kasm_sessions_workspace_id_kasm_workspaces_id_fk": {
          "name": "kasm_sessions_workspace_id_kasm_workspaces_id_fk",
          "tableFrom": "kasm_sessions",
          "tableTo": "kasm_workspaces",
          "columnsFrom": [
            "workspace_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "kasm_sessions_session_token_unique": {
          "name": "kasm_sessions_session_token_unique",
          "nullsNotDistinct": false,
          "columns": [
            "session_token"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.kasm_workspaces": {
      "name": "kasm_workspaces",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "workspace_type": {
          "name": "workspace_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "workspace_name": {
          "name": "workspace_name",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "kasm_session_id": {
          "name": "kasm_session_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "kasm_container_id": {
          "name": "kasm_container_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "kasm_user_id": {
          "name": "kasm_user_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'starting'"
        },
        "access_url": {
          "name": "access_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "internal_ip": {
          "name": "internal_ip",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "cpu_limit": {
          "name": "cpu_limit",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'2'"
        },
        "memory_limit": {
          "name": "memory_limit",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'4096M'"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "last_accessed": {
          "name": "last_accessed",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "expires_at": {
          "name": "expires_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "terminated_at": {
          "name": "terminated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "kasm_workspaces_user_id_users_id_fk": {
          "name": "kasm_workspaces_user_id_users_id_fk",
          "tableFrom": "kasm_workspaces",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "kasm_workspaces_operation_id_operations_id_fk": {
          "name": "kasm_workspaces_operation_id_operations_id_fk",
          "tableFrom": "kasm_workspaces",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "kasm_workspaces_created_by_users_id_fk": {
          "name": "kasm_workspaces_created_by_users_id_fk",
          "tableFrom": "kasm_workspaces",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "kasm_workspaces_kasm_session_id_unique": {
          "name": "kasm_workspaces_kasm_session_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "kasm_session_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.mcp_servers": {
      "name": "mcp_servers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "device_id": {
          "name": "device_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "command": {
          "name": "command",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "args": {
          "name": "args",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "env": {
          "name": "env",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "status": {
          "name": "status",
          "type": "agent_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'stopped'"
        },
        "pid": {
          "name": "pid",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "auto_restart": {
          "name": "auto_restart",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "max_restarts": {
          "name": "max_restarts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 3
        },
        "restart_count": {
          "name": "restart_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "uptime": {
          "name": "uptime",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "last_error": {
          "name": "last_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "mcp_servers_device_id_devices_id_fk": {
          "name": "mcp_servers_device_id_devices_id_fk",
          "tableFrom": "mcp_servers",
          "tableTo": "devices",
          "columnsFrom": [
            "device_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.ollama_models": {
      "name": "ollama_models",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "model_name": {
          "name": "model_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "model_tag": {
          "name": "model_tag",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'latest'"
        },
        "model_size": {
          "name": "model_size",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "parameter_size": {
          "name": "parameter_size",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "quantization": {
          "name": "quantization",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "downloaded_at": {
          "name": "downloaded_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "last_used": {
          "name": "last_used",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "usage_count": {
          "name": "usage_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "status": {
          "name": "status",
          "type": "ollama_model_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": false,
          "default": "'available'"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "ollama_models_model_name_unique": {
          "name": "ollama_models_model_name_unique",
          "nullsNotDistinct": false,
          "columns": [
            "model_name"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.operation_attack_mapping": {
      "name": "operation_attack_mapping",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "technique_id": {
          "name": "technique_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "tactic_id": {
          "name": "tactic_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'planned'"
        },
        "coverage_percentage": {
          "name": "coverage_percentage",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "evidence_text": {
          "name": "evidence_text",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "executed_at": {
          "name": "executed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false,
          "default": "now()"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "operation_attack_mapping_operation_id_operations_id_fk": {
          "name": "operation_attack_mapping_operation_id_operations_id_fk",
          "tableFrom": "operation_attack_mapping",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "operation_attack_mapping_technique_id_attack_techniques_id_fk": {
          "name": "operation_attack_mapping_technique_id_attack_techniques_id_fk",
          "tableFrom": "operation_attack_mapping",
          "tableTo": "attack_techniques",
          "columnsFrom": [
            "technique_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "operation_attack_mapping_tactic_id_attack_tactics_id_fk": {
          "name": "operation_attack_mapping_tactic_id_attack_tactics_id_fk",
          "tableFrom": "operation_attack_mapping",
          "tableTo": "attack_tactics",
          "columnsFrom": [
            "tactic_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "operation_attack_mapping_created_by_users_id_fk": {
          "name": "operation_attack_mapping_created_by_users_id_fk",
          "tableFrom": "operation_attack_mapping",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.operations": {
      "name": "operations",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "operation_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'planning'"
        },
        "objectives": {
          "name": "objectives",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "scope": {
          "name": "scope",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "start_date": {
          "name": "start_date",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "end_date": {
          "name": "end_date",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "owner_id": {
          "name": "owner_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "team_members": {
          "name": "team_members",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "hourly_reporting_enabled": {
          "name": "hourly_reporting_enabled",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "management_status": {
          "name": "management_status",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "last_manager_update": {
          "name": "last_manager_update",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "operations_owner_id_users_id_fk": {
          "name": "operations_owner_id_users_id_fk",
          "tableFrom": "operations",
          "tableTo": "users",
          "columnsFrom": [
            "owner_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.operations_manager_tasks": {
      "name": "operations_manager_tasks",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "task_type": {
          "name": "task_type",
          "type": "manager_task_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "task_name": {
          "name": "task_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "task_description": {
          "name": "task_description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "manager_agent_id": {
          "name": "manager_agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "task_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "priority": {
          "name": "priority",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 5
        },
        "involved_agents": {
          "name": "involved_agents",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "reports_synthesized": {
          "name": "reports_synthesized",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "input_data": {
          "name": "input_data",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "output_data": {
          "name": "output_data",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "decisions": {
          "name": "decisions",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "operations_manager_tasks_operation_id_operations_id_fk": {
          "name": "operations_manager_tasks_operation_id_operations_id_fk",
          "tableFrom": "operations_manager_tasks",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "operations_manager_tasks_manager_agent_id_agents_id_fk": {
          "name": "operations_manager_tasks_manager_agent_id_agents_id_fk",
          "tableFrom": "operations_manager_tasks",
          "tableTo": "agents",
          "columnsFrom": [
            "manager_agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.password_history": {
      "name": "password_history",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "password_hash": {
          "name": "password_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "password_history_user_id_users_id_fk": {
          "name": "password_history_user_id_users_id_fk",
          "tableFrom": "password_history",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.rd_experiments": {
      "name": "rd_experiments",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "project_id": {
          "name": "project_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "hypothesis": {
          "name": "hypothesis",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "methodology": {
          "name": "methodology",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "tools_used": {
          "name": "tools_used",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "targets": {
          "name": "targets",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'planned'"
        },
        "results": {
          "name": "results",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "conclusions": {
          "name": "conclusions",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "success": {
          "name": "success",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false
        },
        "executed_by_agent_id": {
          "name": "executed_by_agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "execution_log": {
          "name": "execution_log",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "rd_experiments_project_id_research_projects_id_fk": {
          "name": "rd_experiments_project_id_research_projects_id_fk",
          "tableFrom": "rd_experiments",
          "tableTo": "research_projects",
          "columnsFrom": [
            "project_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "rd_experiments_executed_by_agent_id_agents_id_fk": {
          "name": "rd_experiments_executed_by_agent_id_agents_id_fk",
          "tableFrom": "rd_experiments",
          "tableTo": "agents",
          "columnsFrom": [
            "executed_by_agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "rd_experiments_workflow_id_agent_workflows_id_fk": {
          "name": "rd_experiments_workflow_id_agent_workflows_id_fk",
          "tableFrom": "rd_experiments",
          "tableTo": "agent_workflows",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.report_templates": {
      "name": "report_templates",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "format": {
          "name": "format",
          "type": "report_format",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pdf'"
        },
        "structure": {
          "name": "structure",
          "type": "json",
          "primaryKey": false,
          "notNull": true
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "report_templates_created_by_users_id_fk": {
          "name": "report_templates_created_by_users_id_fk",
          "tableFrom": "report_templates",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "report_templates_name_unique": {
          "name": "report_templates_name_unique",
          "nullsNotDistinct": false,
          "columns": [
            "name"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.reports": {
      "name": "reports",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "report_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'draft'"
        },
        "format": {
          "name": "format",
          "type": "report_format",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pdf'"
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "template_id": {
          "name": "template_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "content": {
          "name": "content",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "generated_by": {
          "name": "generated_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "file_path": {
          "name": "file_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "file_size": {
          "name": "file_size",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "generated_at": {
          "name": "generated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "reports_operation_id_operations_id_fk": {
          "name": "reports_operation_id_operations_id_fk",
          "tableFrom": "reports",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "reports_template_id_report_templates_id_fk": {
          "name": "reports_template_id_report_templates_id_fk",
          "tableFrom": "reports",
          "tableTo": "report_templates",
          "columnsFrom": [
            "template_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "reports_generated_by_users_id_fk": {
          "name": "reports_generated_by_users_id_fk",
          "tableFrom": "reports",
          "tableTo": "users",
          "columnsFrom": [
            "generated_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.research_projects": {
      "name": "research_projects",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "type": {
          "name": "type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "lead_agent_id": {
          "name": "lead_agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "assigned_agents": {
          "name": "assigned_agents",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "objectives": {
          "name": "objectives",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "success_criteria": {
          "name": "success_criteria",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "findings": {
          "name": "findings",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "artifacts": {
          "name": "artifacts",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        }
      },
      "indexes": {},
      "foreignKeys": {
        "research_projects_lead_agent_id_agents_id_fk": {
          "name": "research_projects_lead_agent_id_agents_id_fk",
          "tableFrom": "research_projects",
          "tableTo": "agents",
          "columnsFrom": [
            "lead_agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "research_projects_created_by_users_id_fk": {
          "name": "research_projects_created_by_users_id_fk",
          "tableFrom": "research_projects",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.rust_nexus_certificates": {
      "name": "rust_nexus_certificates",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "implant_id": {
          "name": "implant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "certificate_type": {
          "name": "certificate_type",
          "type": "rust_nexus_certificate_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "serial_number": {
          "name": "serial_number",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "fingerprint_sha256": {
          "name": "fingerprint_sha256",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "common_name": {
          "name": "common_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "organization": {
          "name": "organization",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "organizational_unit": {
          "name": "organizational_unit",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "country": {
          "name": "country",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "certificate_pem": {
          "name": "certificate_pem",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "public_key_pem": {
          "name": "public_key_pem",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "not_before": {
          "name": "not_before",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "not_after": {
          "name": "not_after",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "is_valid": {
          "name": "is_valid",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": true
        },
        "revoked": {
          "name": "revoked",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "revoked_at": {
          "name": "revoked_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "revocation_reason": {
          "name": "revocation_reason",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "revoked_by": {
          "name": "revoked_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "issuer_common_name": {
          "name": "issuer_common_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "issuer_fingerprint": {
          "name": "issuer_fingerprint",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ca_certificate_id": {
          "name": "ca_certificate_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "last_used_at": {
          "name": "last_used_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "usage_count": {
          "name": "usage_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "rotation_scheduled_at": {
          "name": "rotation_scheduled_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "rotation_completed_at": {
          "name": "rotation_completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "successor_certificate_id": {
          "name": "successor_certificate_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "issued_by": {
          "name": "issued_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "issued_at": {
          "name": "issued_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "rust_nexus_certificates_implant_id_rust_nexus_implants_id_fk": {
          "name": "rust_nexus_certificates_implant_id_rust_nexus_implants_id_fk",
          "tableFrom": "rust_nexus_certificates",
          "tableTo": "rust_nexus_implants",
          "columnsFrom": [
            "implant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "rust_nexus_certificates_revoked_by_users_id_fk": {
          "name": "rust_nexus_certificates_revoked_by_users_id_fk",
          "tableFrom": "rust_nexus_certificates",
          "tableTo": "users",
          "columnsFrom": [
            "revoked_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        },
        "rust_nexus_certificates_issued_by_users_id_fk": {
          "name": "rust_nexus_certificates_issued_by_users_id_fk",
          "tableFrom": "rust_nexus_certificates",
          "tableTo": "users",
          "columnsFrom": [
            "issued_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "rust_nexus_certificates_serial_number_unique": {
          "name": "rust_nexus_certificates_serial_number_unique",
          "nullsNotDistinct": false,
          "columns": [
            "serial_number"
          ]
        },
        "rust_nexus_certificates_fingerprint_sha256_unique": {
          "name": "rust_nexus_certificates_fingerprint_sha256_unique",
          "nullsNotDistinct": false,
          "columns": [
            "fingerprint_sha256"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.rust_nexus_implants": {
      "name": "rust_nexus_implants",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "implant_name": {
          "name": "implant_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "implant_type": {
          "name": "implant_type",
          "type": "implant_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "hostname": {
          "name": "hostname",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "os_type": {
          "name": "os_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "os_version": {
          "name": "os_version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "architecture": {
          "name": "architecture",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "ip_address": {
          "name": "ip_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "mac_address": {
          "name": "mac_address",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "implant_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'registered'"
        },
        "last_heartbeat": {
          "name": "last_heartbeat",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "connection_quality": {
          "name": "connection_quality",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 100
        },
        "certificate_serial": {
          "name": "certificate_serial",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "certificate_fingerprint": {
          "name": "certificate_fingerprint",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "auth_token": {
          "name": "auth_token",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "capabilities": {
          "name": "capabilities",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "max_concurrent_tasks": {
          "name": "max_concurrent_tasks",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 3
        },
        "ai_provider": {
          "name": "ai_provider",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "ai_model": {
          "name": "ai_model",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "autonomy_level": {
          "name": "autonomy_level",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 1
        },
        "total_tasks_completed": {
          "name": "total_tasks_completed",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "total_tasks_failed": {
          "name": "total_tasks_failed",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "total_bytes_transferred": {
          "name": "total_bytes_transferred",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "average_response_time_ms": {
          "name": "average_response_time_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "tags": {
          "name": "tags",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'"
        },
        "registered_at": {
          "name": "registered_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "first_connection_at": {
          "name": "first_connection_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "last_connection_at": {
          "name": "last_connection_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "terminated_at": {
          "name": "terminated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "rust_nexus_implants_operation_id_operations_id_fk": {
          "name": "rust_nexus_implants_operation_id_operations_id_fk",
          "tableFrom": "rust_nexus_implants",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "rust_nexus_implants_created_by_users_id_fk": {
          "name": "rust_nexus_implants_created_by_users_id_fk",
          "tableFrom": "rust_nexus_implants",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "rust_nexus_implants_implant_name_unique": {
          "name": "rust_nexus_implants_implant_name_unique",
          "nullsNotDistinct": false,
          "columns": [
            "implant_name"
          ]
        },
        "rust_nexus_implants_certificate_serial_unique": {
          "name": "rust_nexus_implants_certificate_serial_unique",
          "nullsNotDistinct": false,
          "columns": [
            "certificate_serial"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.rust_nexus_task_results": {
      "name": "rust_nexus_task_results",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "task_id": {
          "name": "task_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "implant_id": {
          "name": "implant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "result_type": {
          "name": "result_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "result_data": {
          "name": "result_data",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "result_json": {
          "name": "result_json",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "file_path": {
          "name": "file_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "file_size": {
          "name": "file_size",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "file_hash": {
          "name": "file_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "file_mime_type": {
          "name": "file_mime_type",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "exit_code": {
          "name": "exit_code",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "execution_time_ms": {
          "name": "execution_time_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "memory_used_mb": {
          "name": "memory_used_mb",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "cpu_usage_percent": {
          "name": "cpu_usage_percent",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "parsed_successfully": {
          "name": "parsed_successfully",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "parsing_errors": {
          "name": "parsing_errors",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "extracted_data": {
          "name": "extracted_data",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "contains_credentials": {
          "name": "contains_credentials",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "contains_sensitive_data": {
          "name": "contains_sensitive_data",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "security_flags": {
          "name": "security_flags",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "captured_at": {
          "name": "captured_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "rust_nexus_task_results_task_id_rust_nexus_tasks_id_fk": {
          "name": "rust_nexus_task_results_task_id_rust_nexus_tasks_id_fk",
          "tableFrom": "rust_nexus_task_results",
          "tableTo": "rust_nexus_tasks",
          "columnsFrom": [
            "task_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "rust_nexus_task_results_implant_id_rust_nexus_implants_id_fk": {
          "name": "rust_nexus_task_results_implant_id_rust_nexus_implants_id_fk",
          "tableFrom": "rust_nexus_task_results",
          "tableTo": "rust_nexus_implants",
          "columnsFrom": [
            "implant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.rust_nexus_tasks": {
      "name": "rust_nexus_tasks",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "implant_id": {
          "name": "implant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "task_type": {
          "name": "task_type",
          "type": "rust_nexus_task_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "task_name": {
          "name": "task_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "task_description": {
          "name": "task_description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "command": {
          "name": "command",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "parameters": {
          "name": "parameters",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "environment_vars": {
          "name": "environment_vars",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "priority": {
          "name": "priority",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 5
        },
        "timeout_seconds": {
          "name": "timeout_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 300
        },
        "retry_count": {
          "name": "retry_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "max_retries": {
          "name": "max_retries",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 3
        },
        "status": {
          "name": "status",
          "type": "rust_nexus_task_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'queued'"
        },
        "progress_percentage": {
          "name": "progress_percentage",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "requires_ai_approval": {
          "name": "requires_ai_approval",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "ai_approved": {
          "name": "ai_approved",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false
        },
        "ai_reasoning": {
          "name": "ai_reasoning",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "assigned_at": {
          "name": "assigned_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "execution_time_ms": {
          "name": "execution_time_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_stack": {
          "name": "error_stack",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "depends_on_task_ids": {
          "name": "depends_on_task_ids",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'"
        },
        "blocks_task_ids": {
          "name": "blocks_task_ids",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "tags": {
          "name": "tags",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'"
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "rust_nexus_tasks_implant_id_rust_nexus_implants_id_fk": {
          "name": "rust_nexus_tasks_implant_id_rust_nexus_implants_id_fk",
          "tableFrom": "rust_nexus_tasks",
          "tableTo": "rust_nexus_implants",
          "columnsFrom": [
            "implant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "rust_nexus_tasks_operation_id_operations_id_fk": {
          "name": "rust_nexus_tasks_operation_id_operations_id_fk",
          "tableFrom": "rust_nexus_tasks",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "rust_nexus_tasks_workflow_id_agent_workflows_id_fk": {
          "name": "rust_nexus_tasks_workflow_id_agent_workflows_id_fk",
          "tableFrom": "rust_nexus_tasks",
          "tableTo": "agent_workflows",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "rust_nexus_tasks_created_by_users_id_fk": {
          "name": "rust_nexus_tasks_created_by_users_id_fk",
          "tableFrom": "rust_nexus_tasks",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.rust_nexus_telemetry": {
      "name": "rust_nexus_telemetry",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "implant_id": {
          "name": "implant_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "cpu_usage_percent": {
          "name": "cpu_usage_percent",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "memory_usage_mb": {
          "name": "memory_usage_mb",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "memory_total_mb": {
          "name": "memory_total_mb",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "disk_usage_gb": {
          "name": "disk_usage_gb",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "disk_total_gb": {
          "name": "disk_total_gb",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "network_latency_ms": {
          "name": "network_latency_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "network_bandwidth_kbps": {
          "name": "network_bandwidth_kbps",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "packets_sent": {
          "name": "packets_sent",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "packets_received": {
          "name": "packets_received",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "bytes_sent": {
          "name": "bytes_sent",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "bytes_received": {
          "name": "bytes_received",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "process_count": {
          "name": "process_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "thread_count": {
          "name": "thread_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "handle_count": {
          "name": "handle_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "uptime_seconds": {
          "name": "uptime_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "active_tasks": {
          "name": "active_tasks",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "queued_tasks": {
          "name": "queued_tasks",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "completed_tasks_last_hour": {
          "name": "completed_tasks_last_hour",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "failed_tasks_last_hour": {
          "name": "failed_tasks_last_hour",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "connection_drops_count": {
          "name": "connection_drops_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "reconnection_attempts": {
          "name": "reconnection_attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "last_connection_error": {
          "name": "last_connection_error",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "health_status": {
          "name": "health_status",
          "type": "health_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "health_score": {
          "name": "health_score",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "health_issues": {
          "name": "health_issues",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'"
        },
        "anomaly_detected": {
          "name": "anomaly_detected",
          "type": "boolean",
          "primaryKey": false,
          "notNull": false,
          "default": false
        },
        "anomaly_type": {
          "name": "anomaly_type",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "anomaly_severity": {
          "name": "anomaly_severity",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "anomaly_description": {
          "name": "anomaly_description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "security_events_count": {
          "name": "security_events_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "last_security_event": {
          "name": "last_security_event",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_security_event_at": {
          "name": "last_security_event_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "ai_inference_count": {
          "name": "ai_inference_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "ai_average_latency_ms": {
          "name": "ai_average_latency_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "ai_error_count": {
          "name": "ai_error_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "custom_metrics": {
          "name": "custom_metrics",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "collected_at": {
          "name": "collected_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        },
        "received_at": {
          "name": "received_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "rust_nexus_telemetry_implant_id_rust_nexus_implants_id_fk": {
          "name": "rust_nexus_telemetry_implant_id_rust_nexus_implants_id_fk",
          "tableFrom": "rust_nexus_telemetry",
          "tableTo": "rust_nexus_implants",
          "columnsFrom": [
            "implant_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.security_tools": {
      "name": "security_tools",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "tool_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'available'"
        },
        "command": {
          "name": "command",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "docker_image": {
          "name": "docker_image",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "endpoint": {
          "name": "endpoint",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "config_path": {
          "name": "config_path",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_used": {
          "name": "last_used",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "usage_count": {
          "name": "usage_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.server_logs": {
      "name": "server_logs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "server_id": {
          "name": "server_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "level": {
          "name": "level",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "message": {
          "name": "message",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "context": {
          "name": "context",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "timestamp": {
          "name": "timestamp",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "server_logs_server_id_mcp_servers_id_fk": {
          "name": "server_logs_server_id_mcp_servers_id_fk",
          "tableFrom": "server_logs",
          "tableTo": "mcp_servers",
          "columnsFrom": [
            "server_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.sessions": {
      "name": "sessions",
      "schema": "",
      "columns": {
        "sid": {
          "name": "sid",
          "type": "text",
          "primaryKey": true,
          "notNull": true
        },
        "sess": {
          "name": "sess",
          "type": "json",
          "primaryKey": false,
          "notNull": true
        },
        "expire": {
          "name": "expire",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.surface_assessments": {
      "name": "surface_assessments",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'active'"
        },
        "total_assets": {
          "name": "total_assets",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "total_services": {
          "name": "total_services",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "total_vulnerabilities": {
          "name": "total_vulnerabilities",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "last_scan_at": {
          "name": "last_scan_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "surface_assessments_operation_id_operations_id_fk": {
          "name": "surface_assessments_operation_id_operations_id_fk",
          "tableFrom": "surface_assessments",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.targets": {
      "name": "targets",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "type": {
          "name": "type",
          "type": "target_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "value": {
          "name": "value",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "priority": {
          "name": "priority",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 3
        },
        "tags": {
          "name": "tags",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "discovered_services": {
          "name": "discovered_services",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "targets_operation_id_operations_id_fk": {
          "name": "targets_operation_id_operations_id_fk",
          "tableFrom": "targets",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_executions": {
      "name": "tool_executions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tool_id": {
          "name": "tool_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "user_id": {
          "name": "user_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "target_id": {
          "name": "target_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "agent_id": {
          "name": "agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "command": {
          "name": "command",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "parameters": {
          "name": "parameters",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "status": {
          "name": "status",
          "type": "tool_execution_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "exit_code": {
          "name": "exit_code",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "stdout": {
          "name": "stdout",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "stderr": {
          "name": "stderr",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "parsed_output": {
          "name": "parsed_output",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "start_time": {
          "name": "start_time",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "end_time": {
          "name": "end_time",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "duration_ms": {
          "name": "duration_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "timeout_ms": {
          "name": "timeout_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 300000
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tool_executions_tool_id_tool_registry_id_fk": {
          "name": "tool_executions_tool_id_tool_registry_id_fk",
          "tableFrom": "tool_executions",
          "tableTo": "tool_registry",
          "columnsFrom": [
            "tool_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "tool_executions_user_id_users_id_fk": {
          "name": "tool_executions_user_id_users_id_fk",
          "tableFrom": "tool_executions",
          "tableTo": "users",
          "columnsFrom": [
            "user_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "tool_executions_operation_id_operations_id_fk": {
          "name": "tool_executions_operation_id_operations_id_fk",
          "tableFrom": "tool_executions",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "tool_executions_target_id_targets_id_fk": {
          "name": "tool_executions_target_id_targets_id_fk",
          "tableFrom": "tool_executions",
          "tableTo": "targets",
          "columnsFrom": [
            "target_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        },
        "tool_executions_agent_id_agents_id_fk": {
          "name": "tool_executions_agent_id_agents_id_fk",
          "tableFrom": "tool_executions",
          "tableTo": "agents",
          "columnsFrom": [
            "agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_library": {
      "name": "tool_library",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "security_tool_id": {
          "name": "security_tool_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "research_value": {
          "name": "research_value",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'medium'"
        },
        "testing_status": {
          "name": "testing_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false,
          "default": "'untested'"
        },
        "compatible_agents": {
          "name": "compatible_agents",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "required_capabilities": {
          "name": "required_capabilities",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'"
        },
        "last_tested_at": {
          "name": "last_tested_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "test_results": {
          "name": "test_results",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "known_issues": {
          "name": "known_issues",
          "type": "text[]",
          "primaryKey": false,
          "notNull": false
        },
        "execution_count": {
          "name": "execution_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "success_rate": {
          "name": "success_rate",
          "type": "real",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "avg_execution_time_seconds": {
          "name": "avg_execution_time_seconds",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "usage_examples": {
          "name": "usage_examples",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "research_notes": {
          "name": "research_notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tool_library_security_tool_id_security_tools_id_fk": {
          "name": "tool_library_security_tool_id_security_tools_id_fk",
          "tableFrom": "tool_library",
          "tableTo": "security_tools",
          "columnsFrom": [
            "security_tool_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_output_parsers": {
      "name": "tool_output_parsers",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tool_id": {
          "name": "tool_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "parser_name": {
          "name": "parser_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "parser_type": {
          "name": "parser_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "output_format": {
          "name": "output_format",
          "type": "output_format",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "parser_code": {
          "name": "parser_code",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "regex_patterns": {
          "name": "regex_patterns",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "json_paths": {
          "name": "json_paths",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "xml_paths": {
          "name": "xml_paths",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "example_input": {
          "name": "example_input",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "example_output": {
          "name": "example_output",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tool_output_parsers_tool_id_tool_registry_id_fk": {
          "name": "tool_output_parsers_tool_id_tool_registry_id_fk",
          "tableFrom": "tool_output_parsers",
          "tableTo": "tool_registry",
          "columnsFrom": [
            "tool_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_parameters": {
      "name": "tool_parameters",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tool_id": {
          "name": "tool_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "parameter_name": {
          "name": "parameter_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "parameter_type": {
          "name": "parameter_type",
          "type": "parameter_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "required": {
          "name": "required",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "default_value": {
          "name": "default_value",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "validation_regex": {
          "name": "validation_regex",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "enum_values": {
          "name": "enum_values",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "placeholder": {
          "name": "placeholder",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "help_text": {
          "name": "help_text",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "display_order": {
          "name": "display_order",
          "type": "integer",
          "primaryKey": false,
          "notNull": false,
          "default": 0
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tool_parameters_tool_id_tool_registry_id_fk": {
          "name": "tool_parameters_tool_id_tool_registry_id_fk",
          "tableFrom": "tool_parameters",
          "tableTo": "tool_registry",
          "columnsFrom": [
            "tool_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_registry": {
      "name": "tool_registry",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tool_id": {
          "name": "tool_id",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "name": {
          "name": "name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "version": {
          "name": "version",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "category": {
          "name": "category",
          "type": "tool_category",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "install_method": {
          "name": "install_method",
          "type": "install_method",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "install_command": {
          "name": "install_command",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "docker_image": {
          "name": "docker_image",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "github_url": {
          "name": "github_url",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "binary_path": {
          "name": "binary_path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "config": {
          "name": "config",
          "type": "json",
          "primaryKey": false,
          "notNull": true,
          "default": "'{}'::json"
        },
        "install_status": {
          "name": "install_status",
          "type": "install_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "install_log": {
          "name": "install_log",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "validation_status": {
          "name": "validation_status",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "last_validated": {
          "name": "last_validated",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "tags": {
          "name": "tags",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "notes": {
          "name": "notes",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "homepage": {
          "name": "homepage",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "documentation": {
          "name": "documentation",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "installed_at": {
          "name": "installed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "tool_registry_tool_id_unique": {
          "name": "tool_registry_tool_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "tool_id"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_test_results": {
      "name": "tool_test_results",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tool_id": {
          "name": "tool_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "test_type": {
          "name": "test_type",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "test_command": {
          "name": "test_command",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "expected_exit_code": {
          "name": "expected_exit_code",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "expected_output": {
          "name": "expected_output",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "passed": {
          "name": "passed",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true
        },
        "actual_exit_code": {
          "name": "actual_exit_code",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "actual_output": {
          "name": "actual_output",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "execution_time_ms": {
          "name": "execution_time_ms",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "tested_by": {
          "name": "tested_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "tested_at": {
          "name": "tested_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tool_test_results_tool_id_tool_registry_id_fk": {
          "name": "tool_test_results_tool_id_tool_registry_id_fk",
          "tableFrom": "tool_test_results",
          "tableTo": "tool_registry",
          "columnsFrom": [
            "tool_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "tool_test_results_tested_by_users_id_fk": {
          "name": "tool_test_results_tested_by_users_id_fk",
          "tableFrom": "tool_test_results",
          "tableTo": "users",
          "columnsFrom": [
            "tested_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "set null",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.tool_uploads": {
      "name": "tool_uploads",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "tool_id": {
          "name": "tool_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "filename": {
          "name": "filename",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "original_name": {
          "name": "original_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "mimetype": {
          "name": "mimetype",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "size": {
          "name": "size",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "path": {
          "name": "path",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "uploaded_by": {
          "name": "uploaded_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "metadata": {
          "name": "metadata",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "tool_uploads_tool_id_security_tools_id_fk": {
          "name": "tool_uploads_tool_id_security_tools_id_fk",
          "tableFrom": "tool_uploads",
          "tableTo": "security_tools",
          "columnsFrom": [
            "tool_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "tool_uploads_uploaded_by_users_id_fk": {
          "name": "tool_uploads_uploaded_by_users_id_fk",
          "tableFrom": "tool_uploads",
          "tableTo": "users",
          "columnsFrom": [
            "uploaded_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.users": {
      "name": "users",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "username": {
          "name": "username",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "email": {
          "name": "email",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "password_hash": {
          "name": "password_hash",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "role": {
          "name": "role",
          "type": "user_role",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'operator'"
        },
        "auth_method": {
          "name": "auth_method",
          "type": "auth_method",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'local'"
        },
        "google_id": {
          "name": "google_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "certificate_fingerprint": {
          "name": "certificate_fingerprint",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "must_change_password": {
          "name": "must_change_password",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": false
        },
        "last_login": {
          "name": "last_login",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "failed_login_attempts": {
          "name": "failed_login_attempts",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "locked_until": {
          "name": "locked_until",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {},
      "compositePrimaryKeys": {},
      "uniqueConstraints": {
        "users_username_unique": {
          "name": "users_username_unique",
          "nullsNotDistinct": false,
          "columns": [
            "username"
          ]
        },
        "users_email_unique": {
          "name": "users_email_unique",
          "nullsNotDistinct": false,
          "columns": [
            "email"
          ]
        },
        "users_google_id_unique": {
          "name": "users_google_id_unique",
          "nullsNotDistinct": false,
          "columns": [
            "google_id"
          ]
        },
        "users_certificate_fingerprint_unique": {
          "name": "users_certificate_fingerprint_unique",
          "nullsNotDistinct": false,
          "columns": [
            "certificate_fingerprint"
          ]
        }
      },
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.vulnerabilities": {
      "name": "vulnerabilities",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "severity": {
          "name": "severity",
          "type": "severity",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "cvss_score": {
          "name": "cvss_score",
          "type": "integer",
          "primaryKey": false,
          "notNull": false
        },
        "cvss_vector": {
          "name": "cvss_vector",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "cve_id": {
          "name": "cve_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "cwe_id": {
          "name": "cwe_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "target_id": {
          "name": "target_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "operation_id": {
          "name": "operation_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "template_id": {
          "name": "template_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "proof_of_concept": {
          "name": "proof_of_concept",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "remediation": {
          "name": "remediation",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "references": {
          "name": "references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "affected_services": {
          "name": "affected_services",
          "type": "json",
          "primaryKey": false,
          "notNull": false
        },
        "exploitability": {
          "name": "exploitability",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "impact": {
          "name": "impact",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "status": {
          "name": "status",
          "type": "text",
          "primaryKey": false,
          "notNull": true,
          "default": "'open'"
        },
        "ai_generated": {
          "name": "ai_generated",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "discovered_at": {
          "name": "discovered_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "verified_at": {
          "name": "verified_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "remediated_at": {
          "name": "remediated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "vulnerabilities_target_id_targets_id_fk": {
          "name": "vulnerabilities_target_id_targets_id_fk",
          "tableFrom": "vulnerabilities",
          "tableTo": "targets",
          "columnsFrom": [
            "target_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "vulnerabilities_operation_id_operations_id_fk": {
          "name": "vulnerabilities_operation_id_operations_id_fk",
          "tableFrom": "vulnerabilities",
          "tableTo": "operations",
          "columnsFrom": [
            "operation_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "vulnerabilities_template_id_vulnerability_templates_id_fk": {
          "name": "vulnerabilities_template_id_vulnerability_templates_id_fk",
          "tableFrom": "vulnerabilities",
          "tableTo": "vulnerability_templates",
          "columnsFrom": [
            "template_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.vulnerability_templates": {
      "name": "vulnerability_templates",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "title": {
          "name": "title",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "category": {
          "name": "category",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "description": {
          "name": "description",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "severity": {
          "name": "severity",
          "type": "severity",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "cvss_vector": {
          "name": "cvss_vector",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "cwe_id": {
          "name": "cwe_id",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "remediation_template": {
          "name": "remediation_template",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "poc_template": {
          "name": "poc_template",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "impact_template": {
          "name": "impact_template",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "exploitability_template": {
          "name": "exploitability_template",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "tags": {
          "name": "tags",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "references": {
          "name": "references",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'[]'::json"
        },
        "is_active": {
          "name": "is_active",
          "type": "boolean",
          "primaryKey": false,
          "notNull": true,
          "default": true
        },
        "usage_count": {
          "name": "usage_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "created_by": {
          "name": "created_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "vulnerability_templates_created_by_users_id_fk": {
          "name": "vulnerability_templates_created_by_users_id_fk",
          "tableFrom": "vulnerability_templates",
          "tableTo": "users",
          "columnsFrom": [
            "created_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.vulnerability_versions": {
      "name": "vulnerability_versions",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "vulnerability_id": {
          "name": "vulnerability_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "data": {
          "name": "data",
          "type": "json",
          "primaryKey": false,
          "notNull": true
        },
        "changed_by": {
          "name": "changed_by",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "change_description": {
          "name": "change_description",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "change_type": {
          "name": "change_type",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "vulnerability_versions_vulnerability_id_vulnerabilities_id_fk": {
          "name": "vulnerability_versions_vulnerability_id_vulnerabilities_id_fk",
          "tableFrom": "vulnerability_versions",
          "tableTo": "vulnerabilities",
          "columnsFrom": [
            "vulnerability_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "vulnerability_versions_changed_by_users_id_fk": {
          "name": "vulnerability_versions_changed_by_users_id_fk",
          "tableFrom": "vulnerability_versions",
          "tableTo": "users",
          "columnsFrom": [
            "changed_by"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.workflow_logs": {
      "name": "workflow_logs",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "task_id": {
          "name": "task_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": false
        },
        "level": {
          "name": "level",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "message": {
          "name": "message",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "context": {
          "name": "context",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "timestamp": {
          "name": "timestamp",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "workflow_logs_workflow_id_agent_workflows_id_fk": {
          "name": "workflow_logs_workflow_id_agent_workflows_id_fk",
          "tableFrom": "workflow_logs",
          "tableTo": "agent_workflows",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "workflow_logs_task_id_workflow_tasks_id_fk": {
          "name": "workflow_logs_task_id_workflow_tasks_id_fk",
          "tableFrom": "workflow_logs",
          "tableTo": "workflow_tasks",
          "columnsFrom": [
            "task_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    },
    "public.workflow_tasks": {
      "name": "workflow_tasks",
      "schema": "",
      "columns": {
        "id": {
          "name": "id",
          "type": "uuid",
          "primaryKey": true,
          "notNull": true,
          "default": "gen_random_uuid()"
        },
        "workflow_id": {
          "name": "workflow_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "agent_id": {
          "name": "agent_id",
          "type": "uuid",
          "primaryKey": false,
          "notNull": true
        },
        "task_type": {
          "name": "task_type",
          "type": "task_type",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true
        },
        "task_name": {
          "name": "task_name",
          "type": "text",
          "primaryKey": false,
          "notNull": true
        },
        "status": {
          "name": "status",
          "type": "task_status",
          "typeSchema": "public",
          "primaryKey": false,
          "notNull": true,
          "default": "'pending'"
        },
        "sequence_order": {
          "name": "sequence_order",
          "type": "integer",
          "primaryKey": false,
          "notNull": true
        },
        "input_data": {
          "name": "input_data",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "output_data": {
          "name": "output_data",
          "type": "json",
          "primaryKey": false,
          "notNull": false,
          "default": "'{}'::json"
        },
        "error_message": {
          "name": "error_message",
          "type": "text",
          "primaryKey": false,
          "notNull": false
        },
        "retry_count": {
          "name": "retry_count",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 0
        },
        "max_retries": {
          "name": "max_retries",
          "type": "integer",
          "primaryKey": false,
          "notNull": true,
          "default": 3
        },
        "started_at": {
          "name": "started_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "completed_at": {
          "name": "completed_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": false
        },
        "created_at": {
          "name": "created_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        },
        "updated_at": {
          "name": "updated_at",
          "type": "timestamp",
          "primaryKey": false,
          "notNull": true,
          "default": "now()"
        }
      },
      "indexes": {},
      "foreignKeys": {
        "workflow_tasks_workflow_id_agent_workflows_id_fk": {
          "name": "workflow_tasks_workflow_id_agent_workflows_id_fk",
          "tableFrom": "workflow_tasks",
          "tableTo": "agent_workflows",
          "columnsFrom": [
            "workflow_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "cascade",
          "onUpdate": "no action"
        },
        "workflow_tasks_agent_id_agents_id_fk": {
          "name": "workflow_tasks_agent_id_agents_id_fk",
          "tableFrom": "workflow_tasks",
          "tableTo": "agents",
          "columnsFrom": [
            "agent_id"
          ],
          "columnsTo": [
            "id"
          ],
          "onDelete": "no action",
          "onUpdate": "no action"
        }
      },
      "compositePrimaryKeys": {},
      "uniqueConstraints": {},
      "policies": {},
      "checkConstraints": {},
      "isRLSEnabled": false
    }
  },
  "enums": {
    "public.agent_architecture": {
      "name": "agent_architecture",
      "schema": "public",
      "values": [
        "x64",
        "x86",
        "arm64"
      ]
    },
    "public.agent_build_status": {
      "name": "agent_build_status",
      "schema": "public",
      "values": [
        "pending",
        "building",
        "completed",
        "failed",
        "cancelled"
      ]
    },
    "public.agent_platform": {
      "name": "agent_platform",
      "schema": "public",
      "values": [
        "windows",
        "linux"
      ]
    },
    "public.agent_status": {
      "name": "agent_status",
      "schema": "public",
      "values": [
        "idle",
        "running",
        "error",
        "stopped"
      ]
    },
    "public.agent_type": {
      "name": "agent_type",
      "schema": "public",
      "values": [
        "openai",
        "anthropic",
        "mcp_server",
        "custom"
      ]
    },
    "public.ai_provider": {
      "name": "ai_provider",
      "schema": "public",
      "values": [
        "ollama",
        "openai",
        "anthropic",
        "llama.cpp"
      ]
    },
    "public.asset_status": {
      "name": "asset_status",
      "schema": "public",
      "values": [
        "active",
        "down",
        "unreachable"
      ]
    },
    "public.asset_type": {
      "name": "asset_type",
      "schema": "public",
      "values": [
        "host",
        "domain",
        "ip",
        "network",
        "url"
      ]
    },
    "public.attack_object_type": {
      "name": "attack_object_type",
      "schema": "public",
      "values": [
        "technique",
        "tactic",
        "group",
        "software",
        "mitigation",
        "data-source",
        "campaign"
      ]
    },
    "public.attack_platform": {
      "name": "attack_platform",
      "schema": "public",
      "values": [
        "Windows",
        "macOS",
        "Linux",
        "Cloud",
        "Network",
        "Containers",
        "IaaS",
        "SaaS",
        "Office 365",
        "Azure AD",
        "Google Workspace",
        "PRE"
      ]
    },
    "public.auth_method": {
      "name": "auth_method",
      "schema": "public",
      "values": [
        "local",
        "google_oauth",
        "certificate",
        "api_key"
      ]
    },
    "public.container_status": {
      "name": "container_status",
      "schema": "public",
      "values": [
        "running",
        "stopped",
        "paused",
        "restarting",
        "dead"
      ]
    },
    "public.discovery_method": {
      "name": "discovery_method",
      "schema": "public",
      "values": [
        "bbot",
        "nuclei",
        "nmap",
        "manual"
      ]
    },
    "public.empire_agent_status": {
      "name": "empire_agent_status",
      "schema": "public",
      "values": [
        "active",
        "pending",
        "lost",
        "killed"
      ]
    },
    "public.empire_listener_type": {
      "name": "empire_listener_type",
      "schema": "public",
      "values": [
        "http",
        "https",
        "http_foreign",
        "http_hop",
        "http_mapi",
        "onedrive",
        "redirector"
      ]
    },
    "public.empire_task_status": {
      "name": "empire_task_status",
      "schema": "public",
      "values": [
        "queued",
        "sent",
        "completed",
        "error"
      ]
    },
    "public.health_status": {
      "name": "health_status",
      "schema": "public",
      "values": [
        "healthy",
        "degraded",
        "unhealthy",
        "critical"
      ]
    },
    "public.implant_status": {
      "name": "implant_status",
      "schema": "public",
      "values": [
        "registered",
        "connected",
        "idle",
        "busy",
        "disconnected",
        "terminated"
      ]
    },
    "public.implant_type": {
      "name": "implant_type",
      "schema": "public",
      "values": [
        "reconnaissance",
        "exploitation",
        "exfiltration",
        "general"
      ]
    },
    "public.install_method": {
      "name": "install_method",
      "schema": "public",
      "values": [
        "apt",
        "pip",
        "npm",
        "go-install",
        "cargo",
        "docker",
        "github-binary",
        "github-source",
        "manual"
      ]
    },
    "public.install_status": {
      "name": "install_status",
      "schema": "public",
      "values": [
        "pending",
        "installing",
        "installed",
        "failed",
        "updating"
      ]
    },
    "public.manager_task_type": {
      "name": "manager_task_type",
      "schema": "public",
      "values": [
        "synthesis",
        "status_update",
        "question_generation",
        "coordination",
        "analysis"
      ]
    },
    "public.ollama_model_status": {
      "name": "ollama_model_status",
      "schema": "public",
      "values": [
        "available",
        "downloading",
        "loading",
        "loaded",
        "unloaded",
        "error"
      ]
    },
    "public.operation_status": {
      "name": "operation_status",
      "schema": "public",
      "values": [
        "planning",
        "active",
        "paused",
        "completed",
        "cancelled"
      ]
    },
    "public.output_format": {
      "name": "output_format",
      "schema": "public",
      "values": [
        "json",
        "xml",
        "csv",
        "text",
        "nmap-xml",
        "custom"
      ]
    },
    "public.parameter_type": {
      "name": "parameter_type",
      "schema": "public",
      "values": [
        "string",
        "number",
        "boolean",
        "array",
        "file",
        "ip-address",
        "cidr",
        "url",
        "port",
        "enum"
      ]
    },
    "public.question_status": {
      "name": "question_status",
      "schema": "public",
      "values": [
        "pending",
        "answered",
        "dismissed",
        "escalated"
      ]
    },
    "public.question_type": {
      "name": "question_type",
      "schema": "public",
      "values": [
        "context",
        "scope",
        "priority",
        "classification",
        "verification"
      ]
    },
    "public.report_format": {
      "name": "report_format",
      "schema": "public",
      "values": [
        "pdf",
        "docx",
        "html",
        "markdown"
      ]
    },
    "public.report_status": {
      "name": "report_status",
      "schema": "public",
      "values": [
        "draft",
        "completed",
        "archived"
      ]
    },
    "public.report_type": {
      "name": "report_type",
      "schema": "public",
      "values": [
        "hourly_status",
        "milestone",
        "roadblock",
        "change_detection",
        "issue_report"
      ]
    },
    "public.rust_nexus_certificate_type": {
      "name": "rust_nexus_certificate_type",
      "schema": "public",
      "values": [
        "ca",
        "server",
        "client"
      ]
    },
    "public.rust_nexus_task_status": {
      "name": "rust_nexus_task_status",
      "schema": "public",
      "values": [
        "queued",
        "assigned",
        "running",
        "completed",
        "failed",
        "timeout",
        "cancelled",
        "retrying"
      ]
    },
    "public.rust_nexus_task_type": {
      "name": "rust_nexus_task_type",
      "schema": "public",
      "values": [
        "shell_command",
        "file_transfer",
        "process_execution",
        "network_scan",
        "credential_harvest",
        "privilege_escalation",
        "lateral_movement",
        "data_collection",
        "persistence",
        "custom"
      ]
    },
    "public.scan_status": {
      "name": "scan_status",
      "schema": "public",
      "values": [
        "pending",
        "running",
        "completed",
        "failed",
        "cancelled"
      ]
    },
    "public.severity": {
      "name": "severity",
      "schema": "public",
      "values": [
        "critical",
        "high",
        "medium",
        "low",
        "informational"
      ]
    },
    "public.target_type": {
      "name": "target_type",
      "schema": "public",
      "values": [
        "ip",
        "domain",
        "url",
        "network",
        "range"
      ]
    },
    "public.task_status": {
      "name": "task_status",
      "schema": "public",
      "values": [
        "pending",
        "in_progress",
        "completed",
        "failed",
        "skipped"
      ]
    },
    "public.task_type": {
      "name": "task_type",
      "schema": "public",
      "values": [
        "analyze",
        "exploit",
        "report",
        "custom"
      ]
    },
    "public.tool_category": {
      "name": "tool_category",
      "schema": "public",
      "values": [
        "reconnaissance",
        "scanning",
        "exploitation",
        "post-exploitation",
        "wireless",
        "web-application",
        "password-cracking",
        "forensics",
        "social-engineering",
        "reporting",
        "other"
      ]
    },
    "public.tool_execution_status": {
      "name": "tool_execution_status",
      "schema": "public",
      "values": [
        "pending",
        "running",
        "completed",
        "failed",
        "timeout",
        "cancelled"
      ]
    },
    "public.tool_status": {
      "name": "tool_status",
      "schema": "public",
      "values": [
        "available",
        "running",
        "stopped",
        "error"
      ]
    },
    "public.user_role": {
      "name": "user_role",
      "schema": "public",
      "values": [
        "admin",
        "operator",
        "viewer"
      ]
    },
    "public.workflow_status": {
      "name": "workflow_status",
      "schema": "public",
      "values": [
        "pending",
        "running",
        "completed",
        "failed",
        "cancelled"
      ]
    }
  },
  "schemas": {},
  "sequences": {},
  "roles": {},
  "policies": {},
  "views": {},
  "_meta": {
    "columns": {},
    "schemas": {},
    "tables": {}
  }
}